#!/usr/bin/env python3
"""
全ての欠落している路線情報を修正するスクリプト
"""
import csv
import os

# 包括的な駅と路線のマッピング
COMPREHENSIVE_RAILWAYS = {
    # 画像から確認できた駅
    '大手町': '東京メトロ丸ノ内線、東京メトロ東西線、東京メトロ千代田線、東京メトロ半蔵門線、都営三田線',
    '飯田橋': 'JR中央線、JR総武線、東京メトロ東西線、東京メトロ有楽町線、東京メトロ南北線、都営大江戸線',
    '有楽町': 'JR山手線、JR京浜東北線、東京メトロ有楽町線',
    '霞ケ関': '東京メトロ丸ノ内線、東京メトロ日比谷線、東京メトロ千代田線',
    '馬喰町': 'JR総武快速線',
    '神田三崎町': 'JR中央線、JR総武線、都営三田線',
    '水道橋': 'JR中央線、JR総武線、都営三田線',
    
    # 世田谷区
    '宮の坂': '東急世田谷線',
    '尾山台': '東急大井町線',
    '上町': '東急世田谷線',
    '等々力': '東急大井町線',
    
    # 中央区
    '水天宮前': '東京メトロ半蔵門線',
    '馬喰町': 'JR総武快速線',
    '八丁堀': 'JR京葉線、東京メトロ日比谷線',
    '新日本橋': 'JR総武快速線',
    
    # 中野区
    '東中野': 'JR中央・総武線、都営大江戸線',
    '中野富士見町': '東京メトロ丸ノ内線',
    '中野新橋': '東京メトロ丸ノ内線',
    
    # 北区
    '尾久': 'JR東北本線（宇都宮線）、JR高崎線',
    
    # 台東区
    '浅草': '東京メトロ銀座線、都営浅草線、東武スカイツリーライン、つくばエクスプレス',
    '上野': 'JR山手線、JR京浜東北線、JR宇都宮線、JR高崎線、JR常磐線、東京メトロ銀座線、東京メトロ日比谷線',
    '田原町': '東京メトロ銀座線',
    '稲荷町': '東京メトロ銀座線',
    '入谷': '東京メトロ日比谷線',
    '三ノ輪': '東京メトロ日比谷線',
    '蔵前': '都営浅草線、都営大江戸線',
    '御徒町': 'JR山手線、JR京浜東北線',
    '仲御徒町': '東京メトロ日比谷線',
    '新御徒町': '都営大江戸線、つくばエクスプレス',
    
    # 品川区
    '五反田': 'JR山手線、東急池上線、都営浅草線',
    '大崎': 'JR山手線、JR埼京線、JR湘南新宿ライン、東京臨海高速鉄道りんかい線',
    '目黒': 'JR山手線、東京メトロ南北線、都営三田線、東急目黒線',
    '品川': 'JR山手線、JR京浜東北線、JR東海道線、JR横須賀線、JR東海道新幹線、京急本線',
    '大井町': 'JR京浜東北線、東急大井町線、東京臨海高速鉄道りんかい線',
    '天王洲アイル': '東京モノレール羽田空港線、東京臨海高速鉄道りんかい線',
    '新馬場': '京急本線',
    '北品川': '京急本線',
    '青物横丁': '京急本線',
    '鮫洲': '京急本線',
    '立会川': '京急本線',
    '大森海岸': '京急本線',
    '平和島': '京急本線',
    
    # 大田区
    '蒲田': 'JR京浜東北線、東急池上線、東急多摩川線',
    '大森': 'JR京浜東北線',
    '田園調布': '東急東横線、東急目黒線',
    '多摩川': '東急東横線、東急目黒線、東急多摩川線',
    '武蔵新田': '東急多摩川線',
    '下丸子': '東急多摩川線',
    '鵜の木': '東急多摩川線',
    '久が原': '東急池上線',
    '千鳥町': '東急池上線',
    '池上': '東急池上線',
    '蓮沼': '東急池上線',
    '糀谷': '京急空港線',
    '大鳥居': '京急空港線',
    '穴守稲荷': '京急空港線',
    '天空橋': '東京モノレール羽田空港線、京急空港線',
    '羽田空港第1・第2ターミナル': '東京モノレール羽田空港線、京急空港線',
    '羽田空港第3ターミナル': '東京モノレール羽田空港線、京急空港線',
    '整備場': '東京モノレール羽田空港線',
    '昭和島': '東京モノレール羽田空港線',
    '流通センター': '東京モノレール羽田空港線',
    '大井競馬場前': '東京モノレール羽田空港線',
    
    # 渋谷区
    '渋谷': 'JR山手線、JR埼京線、JR湘南新宿ライン、東京メトロ銀座線、東京メトロ半蔵門線、東京メトロ副都心線、東急東横線、東急田園都市線、京王井の頭線',
    '原宿': 'JR山手線、東京メトロ千代田線（明治神宮前）、東京メトロ副都心線（明治神宮前）',
    '恵比寿': 'JR山手線、JR埼京線、JR湘南新宿ライン、東京メトロ日比谷線',
    '代々木': 'JR山手線、JR中央・総武線、都営大江戸線',
    '新宿': 'JR山手線、JR中央線、JR中央・総武線、JR埼京線、JR湘南新宿ライン、小田急線、京王線、東京メトロ丸ノ内線、都営新宿線、都営大江戸線',
    '表参道': '東京メトロ銀座線、東京メトロ千代田線、東京メトロ半蔵門線',
    '明治神宮前': '東京メトロ千代田線、東京メトロ副都心線',
    '代官山': '東急東横線',
    '初台': '京王新線',
    '幡ヶ谷': '京王新線',
    '笹塚': '京王線、京王新線',
    '代々木上原': '小田急線、東京メトロ千代田線',
    '代々木八幡': '小田急線',
    '参宮橋': '小田急線',
    '南新宿': '小田急線',
    '北参道': '東京メトロ副都心線',
    '神泉': '京王井の頭線',
    
    # 新宿区
    '新宿': 'JR山手線、JR中央線、JR中央・総武線、JR埼京線、JR湘南新宿ライン、小田急線、京王線、東京メトロ丸ノ内線、都営新宿線、都営大江戸線',
    '新宿三丁目': '東京メトロ丸ノ内線、東京メトロ副都心線、都営新宿線',
    '高田馬場': 'JR山手線、西武新宿線、東京メトロ東西線',
    '新大久保': 'JR山手線',
    '大久保': 'JR中央・総武線',
    '東新宿': '東京メトロ副都心線、都営大江戸線',
    '西新宿': '東京メトロ丸ノ内線',
    '西新宿五丁目': '都営大江戸線',
    '都庁前': '都営大江戸線',
    '新宿御苑前': '東京メトロ丸ノ内線',
    '四谷': 'JR中央線、JR中央・総武線、東京メトロ丸ノ内線、東京メトロ南北線',
    '四谷三丁目': '東京メトロ丸ノ内線',
    '信濃町': 'JR中央・総武線',
    '市ヶ谷': 'JR中央・総武線、東京メトロ有楽町線、東京メトロ南北線、都営新宿線',
    '飯田橋': 'JR中央・総武線、東京メトロ東西線、東京メトロ有楽町線、東京メトロ南北線、都営大江戸線',
    '神楽坂': '東京メトロ東西線',
    '牛込神楽坂': '都営大江戸線',
    '牛込柳町': '都営大江戸線',
    '若松河田': '都営大江戸線',
    '早稲田': '東京メトロ東西線、都電荒川線',
    '西早稲田': '東京メトロ副都心線',
    '下落合': '西武新宿線',
    '中井': '西武新宿線、都営大江戸線',
    '曙橋': '都営新宿線',
    
    # 文京区
    '後楽園': '東京メトロ丸ノ内線、東京メトロ南北線',
    '春日': '都営三田線、都営大江戸線',
    '本郷三丁目': '東京メトロ丸ノ内線、都営大江戸線',
    '御茶ノ水': 'JR中央線、JR中央・総武線、東京メトロ丸ノ内線',
    '新御茶ノ水': '東京メトロ千代田線',
    '大塚': 'JR山手線、都電荒川線',
    '茗荷谷': '東京メトロ丸ノ内線',
    '護国寺': '東京メトロ有楽町線',
    '江戸川橋': '東京メトロ有楽町線',
    '千駄木': '東京メトロ千代田線',
    '根津': '東京メトロ千代田線',
    '湯島': '東京メトロ千代田線',
    '本駒込': '東京メトロ南北線',
    '東大前': '東京メトロ南北線',
    '白山': '都営三田線',
    '千石': '都営三田線',
    
    # 墨田区
    '錦糸町': 'JR総武線、JR総武快速線、東京メトロ半蔵門線',
    '両国': 'JR総武線、都営大江戸線',
    '押上': '東京メトロ半蔵門線、都営浅草線、京成押上線、東武スカイツリーライン',
    'とうきょうスカイツリー': '東武スカイツリーライン',
    '曳舟': '東武スカイツリーライン、東武亀戸線',
    '東向島': '東武スカイツリーライン',
    '鐘ヶ淵': '東武スカイツリーライン',
    '堀切': '東武スカイツリーライン',
    '東あずま': '東武亀戸線',
    '小村井': '東武亀戸線',
    '菊川': '都営新宿線',
    '住吉': '東京メトロ半蔵門線、都営新宿線',
    '森下': '都営新宿線、都営大江戸線',
    '本所吾妻橋': '都営浅草線',
    
    # 江東区
    '門前仲町': '東京メトロ東西線、都営大江戸線',
    '木場': '東京メトロ東西線',
    '東陽町': '東京メトロ東西線',
    '南砂町': '東京メトロ東西線',
    '西葛西': '東京メトロ東西線',
    '葛西': '東京メトロ東西線',
    '清澄白河': '東京メトロ半蔵門線、都営大江戸線',
    '住吉': '東京メトロ半蔵門線、都営新宿線',
    '西大島': '都営新宿線',
    '大島': '都営新宿線',
    '東大島': '都営新宿線',
    '豊洲': '東京メトロ有楽町線、ゆりかもめ',
    '辰巳': '東京メトロ有楽町線',
    '新木場': 'JR京葉線、東京メトロ有楽町線、東京臨海高速鉄道りんかい線',
    '潮見': 'JR京葉線',
    '越中島': 'JR京葉線',
    '亀戸': 'JR総武線、東武亀戸線',
    '亀戸水神': '東武亀戸線',
    '東雲': '東京臨海高速鉄道りんかい線',
    '国際展示場': '東京臨海高速鉄道りんかい線',
    '東京テレポート': '東京臨海高速鉄道りんかい線',
    '青海': 'ゆりかもめ',
    '台場': 'ゆりかもめ',
    'お台場海浜公園': 'ゆりかもめ',
    '船の科学館': 'ゆりかもめ',
    'テレコムセンター': 'ゆりかもめ',
    '有明': 'ゆりかもめ、東京臨海高速鉄道りんかい線',
    '有明テニスの森': 'ゆりかもめ',
    '市場前': 'ゆりかもめ',
    '新豊洲': 'ゆりかもめ',
    
    # 港区
    '新橋': 'JR山手線、JR京浜東北線、JR東海道線、JR横須賀線、東京メトロ銀座線、都営浅草線、ゆりかもめ',
    '浜松町': 'JR山手線、JR京浜東北線、東京モノレール羽田空港線',
    '田町': 'JR山手線、JR京浜東北線、都営三田線（三田）',
    '品川': 'JR山手線、JR京浜東北線、JR東海道線、JR横須賀線、JR東海道新幹線、京急本線',
    '高輪台': '都営浅草線',
    '泉岳寺': '都営浅草線、京急本線',
    '白金高輪': '東京メトロ南北線、都営三田線',
    '白金台': '東京メトロ南北線、都営三田線',
    '広尾': '東京メトロ日比谷線',
    '六本木': '東京メトロ日比谷線、都営大江戸線',
    '六本木一丁目': '東京メトロ南北線',
    '麻布十番': '東京メトロ南北線、都営大江戸線',
    '赤坂見附': '東京メトロ銀座線、東京メトロ丸ノ内線',
    '赤坂': '東京メトロ千代田線',
    '溜池山王': '東京メトロ銀座線、東京メトロ南北線',
    '虎ノ門': '東京メトロ銀座線',
    '虎ノ門ヒルズ': '東京メトロ日比谷線',
    '神谷町': '東京メトロ日比谷線',
    '御成門': '都営三田線',
    '大門': '都営浅草線、都営大江戸線',
    '三田': '都営浅草線、都営三田線',
    '芝公園': '都営三田線',
    '汐留': '都営大江戸線、ゆりかもめ',
    '竹芝': 'ゆりかもめ',
    '日の出': 'ゆりかもめ',
    '芝浦ふ頭': 'ゆりかもめ',
    
    # 千代田区
    '東京': 'JR山手線、JR京浜東北線、JR東海道線、JR中央線、JR総武快速線、JR京葉線、JR東海道新幹線、東京メトロ丸ノ内線',
    '有楽町': 'JR山手線、JR京浜東北線、東京メトロ有楽町線',
    '秋葉原': 'JR山手線、JR京浜東北線、JR総武線、東京メトロ日比谷線、つくばエクスプレス',
    '神田': 'JR山手線、JR京浜東北線、JR中央線、東京メトロ銀座線',
    '御茶ノ水': 'JR中央線、JR中央・総武線、東京メトロ丸ノ内線',
    '水道橋': 'JR中央・総武線、都営三田線',
    '飯田橋': 'JR中央・総武線、東京メトロ東西線、東京メトロ有楽町線、東京メトロ南北線、都営大江戸線',
    '市ヶ谷': 'JR中央・総武線、東京メトロ有楽町線、東京メトロ南北線、都営新宿線',
    '四ツ谷': 'JR中央線、JR中央・総武線、東京メトロ丸ノ内線、東京メトロ南北線',
    '麹町': '東京メトロ有楽町線',
    '半蔵門': '東京メトロ半蔵門線',
    '永田町': '東京メトロ有楽町線、東京メトロ半蔵門線、東京メトロ南北線',
    '赤坂見附': '東京メトロ銀座線、東京メトロ丸ノ内線',
    '霞ケ関': '東京メトロ丸ノ内線、東京メトロ日比谷線、東京メトロ千代田線',
    '日比谷': '東京メトロ日比谷線、東京メトロ千代田線、都営三田線',
    '二重橋前': '東京メトロ千代田線',
    '大手町': '東京メトロ丸ノ内線、東京メトロ東西線、東京メトロ千代田線、東京メトロ半蔵門線、都営三田線',
    '竹橋': '東京メトロ東西線',
    '九段下': '東京メトロ東西線、東京メトロ半蔵門線、都営新宿線',
    '神保町': '東京メトロ半蔵門線、都営三田線、都営新宿線',
    '小川町': '都営新宿線',
    '岩本町': '都営新宿線',
    '末広町': '東京メトロ銀座線',
    '淡路町': '東京メトロ丸ノ内線',
    '新御茶ノ水': '東京メトロ千代田線',
    
    # 杉並区
    '荻窪': 'JR中央線、JR中央・総武線、東京メトロ丸ノ内線',
    '西荻窪': 'JR中央線、JR中央・総武線',
    '阿佐ケ谷': 'JR中央線、JR中央・総武線',
    '高円寺': 'JR中央線、JR中央・総武線',
    '南阿佐ケ谷': '東京メトロ丸ノ内線',
    '新高円寺': '東京メトロ丸ノ内線',
    '東高円寺': '東京メトロ丸ノ内線',
    '方南町': '東京メトロ丸ノ内線',
    '永福町': '京王井の頭線',
    '西永福': '京王井の頭線',
    '浜田山': '京王井の頭線',
    '高井戸': '京王井の頭線',
    '富士見ヶ丘': '京王井の頭線',
    '久我山': '京王井の頭線',
    '下井草': '西武新宿線',
    '井荻': '西武新宿線',
    '上井草': '西武新宿線',
    '八幡山': '京王線',
    '上北沢': '京王線',
    '芦花公園': '京王線',
    
    # 練馬区
    '練馬': '西武池袋線、西武豊島線、都営大江戸線',
    '中村橋': '西武池袋線',
    '富士見台': '西武池袋線',
    '練馬高野台': '西武池袋線',
    '石神井公園': '西武池袋線',
    '大泉学園': '西武池袋線',
    '保谷': '西武池袋線',
    '東長崎': '西武池袋線',
    '江古田': '西武池袋線',
    '桜台': '西武池袋線',
    '豊島園': '西武豊島線、都営大江戸線',
    '新江古田': '都営大江戸線',
    '光が丘': '都営大江戸線',
    '練馬春日町': '都営大江戸線',
    '平和台': '東京メトロ有楽町線',
    '氷川台': '東京メトロ有楽町線',
    '小竹向原': '東京メトロ有楽町線、東京メトロ副都心線、西武有楽町線',
    '地下鉄赤塚': '東京メトロ有楽町線、東京メトロ副都心線',
    '地下鉄成増': '東京メトロ有楽町線、東京メトロ副都心線',
    '武蔵関': '西武新宿線',
    '上石神井': '西武新宿線',
    '武蔵境': 'JR中央線、西武多摩川線',
    
    # 板橋区
    '板橋': 'JR埼京線',
    '十条': 'JR埼京線',
    '赤羽': 'JR埼京線、JR京浜東北線、JR宇都宮線、JR高崎線、JR湘南新宿ライン',
    '浮間舟渡': 'JR埼京線',
    '北赤羽': 'JR埼京線',
    '志村坂上': '都営三田線',
    '志村三丁目': '都営三田線',
    '蓮根': '都営三田線',
    '西台': '都営三田線',
    '高島平': '都営三田線',
    '新高島平': '都営三田線',
    '西高島平': '都営三田線',
    '本蓮沼': '都営三田線',
    '板橋本町': '都営三田線',
    '板橋区役所前': '都営三田線',
    '新板橋': '都営三田線',
    '成増': '東武東上線',
    '下赤塚': '東武東上線',
    '東武練馬': '東武東上線',
    '上板橋': '東武東上線',
    'ときわ台': '東武東上線',
    '中板橋': '東武東上線',
    '大山': '東武東上線',
    
    # 足立区
    '北千住': 'JR常磐線、東京メトロ千代田線、東京メトロ日比谷線、東武スカイツリーライン、つくばエクスプレス',
    '綾瀬': 'JR常磐線、東京メトロ千代田線',
    '亀有': 'JR常磐線',
    '金町': 'JR常磐線、京成金町線',
    '西新井': '東武スカイツリーライン、東武大師線',
    '梅島': '東武スカイツリーライン',
    '五反野': '東武スカイツリーライン',
    '小菅': '東武スカイツリーライン',
    '北綾瀬': '東京メトロ千代田線',
    '足立小台': '日暮里・舎人ライナー',
    '扇大橋': '日暮里・舎人ライナー',
    '高野': '日暮里・舎人ライナー',
    '江北': '日暮里・舎人ライナー',
    '西新井大師西': '日暮里・舎人ライナー',
    '谷在家': '日暮里・舎人ライナー',
    '舎人公園': '日暮里・舎人ライナー',
    '舎人': '日暮里・舎人ライナー',
    '見沼代親水公園': '日暮里・舎人ライナー',
    '大師前': '東武大師線',
    '京成関屋': '京成本線',
    '青井': 'つくばエクスプレス',
    '六町': 'つくばエクスプレス',
    
    # 葛飾区
    '亀有': 'JR常磐線',
    '金町': 'JR常磐線、京成金町線',
    '新小岩': 'JR総武線',
    '京成高砂': '京成本線、京成押上線、北総線',
    '青砥': '京成本線、京成押上線',
    '京成立石': '京成押上線',
    '四ツ木': '京成押上線',
    '八広': '京成押上線',
    'お花茶屋': '京成本線',
    '堀切菖蒲園': '京成本線',
    '柴又': '京成金町線',
    '京成金町': '京成金町線',
    '新柴又': '北総線',
    
    # 江戸川区
    '小岩': 'JR総武線',
    '新小岩': 'JR総武線',
    '平井': 'JR総武線',
    '西葛西': '東京メトロ東西線',
    '葛西': '東京メトロ東西線',
    '船堀': '都営新宿線',
    '一之江': '都営新宿線',
    '瑞江': '都営新宿線',
    '篠崎': '都営新宿線',
    '京成小岩': '京成本線',
    '江戸川': '京成本線',
    '国府台': '京成本線',
    
    # 荒川区
    '日暮里': 'JR山手線、JR京浜東北線、JR常磐線、京成本線、日暮里・舎人ライナー',
    '西日暮里': 'JR山手線、JR京浜東北線、東京メトロ千代田線、日暮里・舎人ライナー',
    '三河島': 'JR常磐線',
    '南千住': 'JR常磐線、東京メトロ日比谷線、つくばエクスプレス',
    '町屋': '東京メトロ千代田線、京成本線、都電荒川線',
    '新三河島': '京成本線',
    '京成町屋': '京成本線',
    '千住大橋': '京成本線',
    '赤土小学校前': '日暮里・舎人ライナー',
    '熊野前': '日暮里・舎人ライナー、都電荒川線',
    '宮ノ前': '都電荒川線',
    '小台': '都電荒川線',
    '荒川遊園地前': '都電荒川線',
    '荒川車庫前': '都電荒川線',
    '梶原': '都電荒川線',
    '栄町': '都電荒川線',
    '王子駅前': '都電荒川線',
    '飛鳥山': '都電荒川線',
    '滝野川一丁目': '都電荒川線',
    '西ヶ原四丁目': '都電荒川線',
    '新庚申塚': '都電荒川線',
    '庚申塚': '都電荒川線',
    '巣鴨新田': '都電荒川線',
    '大塚駅前': '都電荒川線',
    '向原': '都電荒川線',
    '東池袋四丁目': '都電荒川線',
    '都電雑司ヶ谷': '都電荒川線',
    '鬼子母神前': '都電荒川線',
    '学習院下': '都電荒川線',
    '面影橋': '都電荒川線',
    '早稲田': '都電荒川線',
    '町屋駅前': '都電荒川線',
    '町屋二丁目': '都電荒川線',
    '東尾久三丁目': '都電荒川線',
    
    # 北区
    '赤羽': 'JR埼京線、JR京浜東北線、JR宇都宮線、JR高崎線、JR湘南新宿ライン',
    '赤羽岩淵': '東京メトロ南北線、埼玉高速鉄道線',
    '王子': 'JR京浜東北線、東京メトロ南北線',
    '東十条': 'JR京浜東北線',
    '十条': 'JR埼京線',
    '板橋': 'JR埼京線',
    '北赤羽': 'JR埼京線',
    '浮間舟渡': 'JR埼京線',
    '尾久': 'JR東北本線（宇都宮線）、JR高崎線',
    '上中里': 'JR京浜東北線',
    '田端': 'JR山手線、JR京浜東北線',
    '駒込': 'JR山手線、東京メトロ南北線',
    '西ヶ原': '東京メトロ南北線',
    '王子神谷': '東京メトロ南北線',
    '志茂': '東京メトロ南北線',
    
    # 豊島区（既に修正済みの駅も含めて完全版）
    '池袋': 'JR山手線、JR埼京線、JR湘南新宿ライン、東武東上線、西武池袋線、東京メトロ丸ノ内線、東京メトロ有楽町線、東京メトロ副都心線',
    '大塚': 'JR山手線、都電荒川線',
    '巣鴨': 'JR山手線、都営三田線',
    '駒込': 'JR山手線、東京メトロ南北線',
    '目白': 'JR山手線',
    '東池袋': '東京メトロ有楽町線',
    '護国寺': '東京メトロ有楽町線',
    '雑司が谷': '東京メトロ副都心線',
    '都電雑司ヶ谷': '都電荒川線',
    '鬼子母神前': '都電荒川線',
    '学習院下': '都電荒川線',
    '面影橋': '都電荒川線',
    '千川': '東京メトロ有楽町線、東京メトロ副都心線',
    '要町': '東京メトロ有楽町線、東京メトロ副都心線',
    '北池袋': '東武東上線',
    '下板橋': '東武東上線',
    '西巣鴨': '都営三田線',
    '新大塚': '東京メトロ丸ノ内線',
    
    # 目黒区
    '目黒': 'JR山手線、東京メトロ南北線、都営三田線、東急目黒線',
    '中目黒': '東京メトロ日比谷線、東急東横線',
    '恵比寿': 'JR山手線、JR埼京線、JR湘南新宿ライン、東京メトロ日比谷線',
    '自由が丘': '東急東横線、東急大井町線',
    '都立大学': '東急東横線',
    '学芸大学': '東急東横線',
    '祐天寺': '東急東横線',
    '不動前': '東急目黒線',
    '武蔵小山': '東急目黒線',
    '西小山': '東急目黒線',
    '洗足': '東急目黒線',
    '大岡山': '東急目黒線、東急大井町線',
    '奥沢': '東急目黒線',
    '緑が丘': '東急大井町線',
    '九品仏': '東急大井町線',
    '尾山台': '東急大井町線',
    '等々力': '東急大井町線',
    '上野毛': '東急大井町線',
    '二子玉川': '東急大井町線、東急田園都市線',
    '駒沢大学': '東急田園都市線',
    '池尻大橋': '東急田園都市線',
}

def fix_all_missing_lines():
    """全ての欠落している路線情報を修正"""
    
    # 入力ファイル
    input_file = "/Users/mitsuimasaharu/Documents/CLI_CODE/tochijihai/tokyo-wellbeing-map/backend/app/data/tokyo_townlist_with_stations_fixed.csv"
    # 出力ファイル
    output_file = "/Users/mitsuimasaharu/Documents/CLI_CODE/tochijihai/tokyo-wellbeing-map/backend/app/data/tokyo_townlist_with_stations_complete_fixed.csv"
    
    # CSVファイルを読み込み
    with open(input_file, 'r', encoding='utf-8-sig') as f:
        reader = csv.DictReader(f)
        rows = list(reader)
    
    # 修正カウンター
    fixed_count = 0
    
    # 各行を処理
    for row in rows:
        station_name = row.get('最寄り駅', '')
        current_line = row.get('路線', '')
        
        # 路線情報が空で、駅名が修正対象に含まれている場合
        if not current_line and station_name in COMPREHENSIVE_RAILWAYS:
            new_line = COMPREHENSIVE_RAILWAYS[station_name]
            row['路線'] = new_line
            
            # 駅情報フィールドも更新
            if row.get('駅情報'):
                # 既存の駅情報から駅名部分を抽出
                if '｜' in row['駅情報']:
                    station_part = row['駅情報'].split('｜')[0]
                else:
                    station_part = row['駅情報']
                
                # 新しい駅情報を設定
                row['駅情報'] = f"{station_part}｜{new_line}"
            else:
                # 駅情報が空の場合は駅名と路線を組み合わせる
                row['駅情報'] = f"{station_name}｜{new_line}"
            
            fixed_count += 1
            print(f"修正: {row['区名']} {row['町名']} - {station_name} → {new_line}")
    
    # 修正後のデータを保存
    with open(output_file, 'w', encoding='utf-8-sig', newline='') as f:
        fieldnames = reader.fieldnames
        writer = csv.DictWriter(f, fieldnames=fieldnames)
        writer.writeheader()
        writer.writerows(rows)
    
    print(f"\n修正完了: {fixed_count}件の路線情報を追加しました")
    print(f"出力ファイル: {output_file}")
    
    # 最終確認：まだ路線情報が空の駅を表示
    remaining_missing = []
    for row in rows:
        station = row.get('最寄り駅', '')
        line = row.get('路線', '')
        if station and not line:
            remaining_missing.append(f"{row['区名']} {row['町名']} - {station}")
    
    if remaining_missing:
        print(f"\n注意: まだ{len(remaining_missing)}件の駅で路線情報が不足しています:")
        for item in remaining_missing[:10]:
            print(f"  {item}")
        if len(remaining_missing) > 10:
            print(f"  他{len(remaining_missing) - 10}件...")

if __name__ == "__main__":
    fix_all_missing_lines()